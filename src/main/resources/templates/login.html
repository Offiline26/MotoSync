<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/_head :: head('Login')}"></head>
<body>

<main class="container">
    <div class="header">
        <h1>Login</h1>
        <a class="btn" th:href="@{/register}">Criar conta</a>
    </div>

    <!-- mensagens do Spring Security -->
    <div th:if="${param.error}" class="alert danger">E-mail ou senha inválidos.</div>
    <div th:if="${param.logout}" class="alert success">Você saiu da conta.</div>
    <div th:if="${param.registered}" class="alert success">Cadastro realizado. Faça login.</div>
    <div th:if="${ok}" class="alert success" th:text="${ok}"></div>
    <div th:if="${error}" class="alert danger" th:text="${error}"></div>

    <!-- IMPORTANTE: os names DEVEM ser 'email' e 'password' -->
    <form th:action="@{/login}" method="post">
        <input type="text"     name="username" placeholder="Email" required>
        <input type="password" name="password" placeholder="Senha"   required>

        <!-- CSRF oculto: ESSENCIAL -->
        <input type="hidden" th:if="${_csrf != null}"
               th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

        <button type="submit">Entrar</button>
    </form>

    <div class="oauth-login">
        <h3>Ou faça login com:</h3>
        <p><a th:href="@{/oauth2/authorization/github}">Continuar com GitHub</a></p>
        <p><a th:href="@{/oauth2/authorization/google}">Continuar com Google</a></p>
    </div>
</main>
</body>
</html>
